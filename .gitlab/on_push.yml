image: golang:1.19

.on_push:
  rules:
    if: $CI_COMMIT_BRANCH == "main"
  script:
    - go fmt $(go list ./...)
    - go vet $(go list ./...)
    - make test
    - make build